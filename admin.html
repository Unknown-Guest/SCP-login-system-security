<!DOCTYPE html>
<html>
<head>
<style>
    :root {
        --scp-green: #3fbf3f;
        --scp-green-soft: #6fdc6f;
        --scp-red: #ff3f3f;
        --scp-gray: #444;
        --scp-gold: #ffcc00;
    }

    body {
        background-color: #000;
        margin: 0;
        padding: 40px;
        font-family: Arial, sans-serif;
        color: var(--scp-green);
    }

    h1 {
        font-size: 28px;
        font-weight: bold;
        text-align: center;
        margin-bottom: 6px;
        letter-spacing: 8px;
        color: var(--scp-green);
        text-shadow: 0 0 8px var(--scp-green), 0 0 2px var(--scp-green);
    }

    #page-sub {
        text-align: center;
        font-size: 10px;
        color: var(--scp-green-soft);
        margin-bottom: 36px;
        letter-spacing: 1.5px;
        text-shadow: 0 0 4px var(--scp-green-soft);
    }

    .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 30px;
        margin-bottom: 12px;
        border-bottom: 1px solid var(--scp-green);
        padding-bottom: 8px;
    }

    .section-header h2 {
        font-size: 14px;
        margin: 0;
        letter-spacing: 3px;
        color: var(--scp-green);
        text-shadow: 0 0 4px var(--scp-green);
    }

    .refresh-btn {
        padding: 5px 12px;
        font-size: 11px;
        cursor: pointer;
        border: 1px solid var(--scp-green);
        background: transparent;
        color: var(--scp-green);
        letter-spacing: 1.5px;
        box-shadow: 0 0 4px var(--scp-green);
        transition: 0.15s;
    }

    .refresh-btn:hover {
        background: var(--scp-green);
        color: #000;
    }

    .request-item, .account-item {
        border: 1px solid var(--scp-green);
        padding: 12px 16px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #050505;
        box-shadow: 0 0 6px #001a00, inset 0 0 2px #001a00;
        font-size: 13px;
    }

    .request-item b, .account-item b {
        color: var(--scp-green-soft);
        text-shadow: 0 0 2px var(--scp-green-soft);
    }

    .admin-btn {
        padding: 6px 12px;
        font-size: 11px;
        cursor: pointer;
        border: 1px solid var(--scp-green);
        background: transparent;
        color: var(--scp-green);
        margin-left: 6px;
        letter-spacing: 1px;
        box-shadow: 0 0 3px var(--scp-green);
        transition: 0.15s;
    }

    .admin-btn:hover {
        background: var(--scp-green);
        color: #000;
    }

    .admin-btn.allow {
        background: var(--scp-green);
        color: #000;
    }

    .admin-btn.allow:hover {
        background: #5fff5f;
    }

    .admin-btn.deny-btn {
        border-color: var(--scp-red);
        color: var(--scp-red);
        box-shadow: 0 0 3px var(--scp-red);
    }

    .admin-btn.deny-btn:hover {
        background: var(--scp-red);
        color: #000;
    }

    .admin-btn.delete {
        border-color: var(--scp-red);
        color: var(--scp-red);
        box-shadow: 0 0 3px var(--scp-red);
    }

    .admin-btn.delete:hover {
        background: var(--scp-red);
        color: #000;
    }

    .admin-btn.delete.disabled {
        border-color: var(--scp-gray);
        color: var(--scp-gray);
        cursor: not-allowed;
        box-shadow: none;
    }

    .admin-btn.delete.disabled:hover {
        background: transparent;
        color: var(--scp-gray);
    }

    .star-btn {
        font-size: 20px;
        cursor: pointer;
        margin-right: 10px;
        user-select: none;
        transition: 0.15s;
    }

    .star-off { color: var(--scp-gray); }
    .star-on {
        color: var(--scp-gold);
        text-shadow: 0 0 6px var(--scp-gold);
    }

    .access-btn {
        padding: 5px 10px;
        margin-left: 6px;
        font-size: 11px;
        cursor: pointer;
        transition: 0.15s;
        border: 1px solid;
        letter-spacing: 0.5px;
        background: transparent;
    }

    .access-on {
        color: var(--scp-green);
        border-color: var(--scp-green);
        box-shadow: 0 0 4px var(--scp-green);
    }

    .access-on:hover {
        background: var(--scp-green);
        color: #000;
        box-shadow: 0 0 8px var(--scp-green);
    }

    .access-off {
        color: var(--scp-red);
        border-color: var(--scp-red);
        box-shadow: 0 0 3px var(--scp-red);
    }

    .access-off:hover {
        background: var(--scp-red);
        color: #000;
        box-shadow: 0 0 8px var(--scp-red);
    }

    .empty-msg {
        font-size: 12px;
        color: var(--scp-gray);
        letter-spacing: 1px;
        padding: 10px 0;
    }
</style>
</head>

<body>

<h1>SCP ADMIN</h1>
<div id="page-sub">// ACCOUNT CONTROL PANEL //</div>

<div class="section-header">
    <h2>PENDING ACCOUNT REQUESTS</h2>
    <button class="refresh-btn" onclick="loadRequests()">⟳ REFRESH</button>
</div>
<div id="request-list"></div>

<div class="section-header" style="margin-top:40px;">
    <h2>CURRENT ACCOUNTS</h2>
</div>
<div id="account-list"></div>

<script>
function safeArray(value) {
    return Array.isArray(value) ? value : [];
}

function loadRequests() {
    let pending = JSON.parse(localStorage.getItem("pendingAccounts")) || [];
    const list = document.getElementById("request-list");
    list.innerHTML = "";

    if (pending.length === 0) {
        list.innerHTML = '<div class="empty-msg">// NO PENDING REQUESTS //</div>';
        return;
    }

    pending.forEach((entry, index) => {
        const div = document.createElement("div");
        div.className = "request-item";
        div.innerHTML = `
            <div>
                <div><b>Name:</b> ${entry.name}</div>
                <div><b>Username:</b> ${entry.username}</div>
                <div><b>Password:</b> ${entry.password}</div>
            </div>
            <div>
                <button class="admin-btn allow" onclick="approve(${index})">▶ ALLOW</button>
                <button class="admin-btn deny-btn" onclick="deny(${index})">✕ DENY</button>
            </div>
        `;
        list.appendChild(div);
    });
}

function loadAccounts() {
    let accounts = JSON.parse(localStorage.getItem("approvedAccounts")) || [];
    const list = document.getElementById("account-list");
    list.innerHTML = "";

    if (accounts.length === 0) {
        list.innerHTML = '<div class="empty-msg">// NO ACCOUNTS FOUND //</div>';
        return;
    }

    accounts.forEach((entry, index) => {
        entry.access = safeArray(entry.access);
        entry.favorite = entry.favorite === true;

        const div = document.createElement("div");
        div.className = "account-item";

        div.innerHTML = `
            <div>
                <div><b>Name:</b> ${entry.name}</div>
                <div><b>Username:</b> ${entry.username}</div>
                <div><b>Password:</b> ${entry.password}</div>
                <div><b>Access:</b> ${entry.access.join(", ") || "None"}</div>
            </div>
            <div style="display:flex; align-items:center;">
                <span class="star-btn ${entry.favorite ? "star-on" : "star-off"}"
                      onclick="toggleFavorite(${index})">★</span>
                <div>
                    ${makeAccessButton(entry, index, "Files")}
                    ${makeAccessButton(entry, index, "Hacks")}
                    ${makeAccessButton(entry, index, "Console")}
                    ${makeAccessButton(entry, index, "Messages")}
                    ${makeAccessButton(entry, index, "Admin")}
                </div>
                <button class="admin-btn delete ${entry.favorite ? "disabled" : ""}"
                        onclick="${entry.favorite ? "" : `deleteAccount(${index})`}">
                    DELETE
                </button>
            </div>
        `;

        list.appendChild(div);
    });
}

function makeAccessButton(entry, index, role) {
    const active = entry.access.includes(role);
    return `<button class="access-btn ${active ? "access-on" : "access-off"}"
        onclick="toggleAccess(${index}, '${role}')">${role}</button>`;
}

function toggleFavorite(index) {
    let accounts = JSON.parse(localStorage.getItem("approvedAccounts")) || [];
    accounts[index].favorite = !accounts[index].favorite;
    localStorage.setItem("approvedAccounts", JSON.stringify(accounts));
    loadAccounts();
}

function toggleAccess(index, role) {
    let accounts = JSON.parse(localStorage.getItem("approvedAccounts")) || [];
    accounts[index].access = safeArray(accounts[index].access);
    if (accounts[index].access.includes(role)) {
        accounts[index].access = accounts[index].access.filter(r => r !== role);
    } else {
        accounts[index].access.push(role);
    }
    localStorage.setItem("approvedAccounts", JSON.stringify(accounts));
    loadAccounts();
}

function approve(index) {
    let pending = JSON.parse(localStorage.getItem("pendingAccounts")) || [];
    let accounts = JSON.parse(localStorage.getItem("approvedAccounts")) || [];
    accounts.push({ name: pending[index].name, username: pending[index].username, password: pending[index].password, access: [], favorite: false });
    pending.splice(index, 1);
    localStorage.setItem("pendingAccounts", JSON.stringify(pending));
    localStorage.setItem("approvedAccounts", JSON.stringify(accounts));
    loadRequests();
    loadAccounts();
}

function deny(index) {
    let pending = JSON.parse(localStorage.getItem("pendingAccounts")) || [];
    pending.splice(index, 1);
    localStorage.setItem("pendingAccounts", JSON.stringify(pending));
    loadRequests();
}

function deleteAccount(index) {
    let accounts = JSON.parse(localStorage.getItem("approvedAccounts")) || [];
    accounts.splice(index, 1);
    localStorage.setItem("approvedAccounts", JSON.stringify(accounts));
    loadAccounts();
}

loadRequests();
loadAccounts();
</script>

</body>
</html>